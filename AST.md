# 翻译AST
> 在计算机科学中，一个**抽象语法树**，简称**语法树**，是用编程语言编写的源代码的抽象语法树的树表示。每个树节点代表一个在源代码中出现的结构。语法是“抽象的”，不代表出现在真实语法中的每个细节（The syntax is "abstract" in not representing every detail appearing in the real syntax)。例如，分组括号（grouping parentheses）在树结构中是“隐式”（implicit）的，并且诸如if-else条件表达式的语法结构可能用三个分支来代表一个单节点的意思。
>
> 这个就是AST和传统上指定解析树的具体语法树（concrete syntax tree）的区别，这些语法树通常由解析器在源代码转换和编译过程中构建。一旦构建，通过后续过程把附加信息添加中AST中，比如，内容上下文。
>
> AST也被使用在编码分析和编码转换系统。

---
       内容
1 在编译器中的应用
    1.1 动机
    1.2 设计
    1.3 设计模式
    1.4 用途
2 see also
3 引用
4 进一步阅读
5 外部链接

---

## 在编译器中的应用
---
> 抽象语法树广泛地用于代表程序代码结构的数据结构。语法树通常是编译器语法分析阶段的结果。语法树通常通过编译器需要的几个阶段（stages）来作为程序的中间表示，并且对编译器的最终输出有很大的影响。

### 动机
+ 语法树可以通过每个元素都包含的属性和注释等信息来编辑和增强。对程序的源代码来说这样的编辑和注释是不可能的，因为这意味着要修改它。
+ 和源码比较，AST不包括不必要的标点和分隔符（比如花括号，分号，圆括号）。
+ AST通常包含程序的额外信息，由于编译器的连续分析阶段。例如，它可能存储这源码中每个元素的位置，这样允许编译器输出有用的错误信息。

> 因为编程语言及其文档的固有特性，ASTs被需要。语言的本质常常是模棱两可的。为了避免这种模糊，编程语言经常被指定为【上下文无关语法】（）（context-free grammar， CFG）。但是，还是有CFG不能表达的程序语言的某些方面，但它们是余元的一部分，并在其规范中有文档说明。这些细节需要上下文来确定它们的正确性（validity）和行为。例如，如果一门语言需要定义新的类型，CFG不能预测这些类型的名字和它们使用的方式。即使一门语言有一组预定义的类型，强制正确使用通常需要一些上下文。另一个例子是duck typing，元素的类型可以根据上下文而改变。操作负载（operation overloading）是另外一种正确的使用和最终功能根据上下文决定的例子。Java提供了一个出色的例子，其中’+‘操作符是数字加法和字符串的连接。
>
> 尽管在编译器的内部工作中还有其他数据结构，AST执行一个独一无二的功能。在第一阶段，即**语法分析**阶段，一个编译器产生一个分析树。这个解析树可以通过语法定向转换（syntax-directed translation）来执行编译器的几乎所有功能。虽然这种方法可以产生更高效的编译器，但它违背了编写和维护程序的软件工程原则。AST相对于解析树的另一个优势是它的大小，特别是AST的更小的高度和元素数量。

### Design
> AST的设计和编译器的设计一起它的预期特性紧密相连。
> 核心需求如下：
+ 变量类型必须保存，以及源码中每个声明的位置。
+ 可执行语句的顺序必须显示地表示并定义良好。
+ 二元运算符的左右部分必须被保存并正确地定义。
+ 标志符以及赋值必须存储在赋值语句中。
>
> 这些需求可以用来为AST设计语法结构。
>
> 有些操作符总是需要两个元素，例如用于加法的两个术语。然而，有些语言结构需要任意多的子元素，比如从命令shell传递给程序的参数列表。因此，用于表示用这种语言编码的代码的AST也必须足够灵活，以便能够快速添加未知数量的子元素。
>
> AST的另一个主要设计需求是，应该可以将AST解析为源代码形式。在重新编译时，生成的源代码在外观上应该与原始代码足够相似，在执行上应该完全相同。

### Design patterns
> 由于AST需求的复杂性和编译器的整体复杂性，应用合理的软件开发方案是有益处的。其中之一就是用验证过（proven）的设计模式来增强模块化和易于开发。
> 不同的操作不一定有不同的类型，因此又一个合理的节点类层次结构是很重要的。这在随着编译器的发展而创建和修改ST是至关重要的。
> 因为编译器遍历树多次以确定语法的正确性，所以使遍历树成为一个简单的操作是很重要的。在叨叨每个节点时，编译器执行一组特定的操作，取决于每个节点的类型，因此使用观察者模式（visitor pattern）通常是有意义的。

### 用途
> 在语义分析中，AST被广泛地使用，其中，编译器检查程序元素和语言的正确用法。在语义分析中，编译器也生成基于AST的符号表（symbol tables）。完整的树遍历允许程序正确性的验证。
> 在验证正确性之后，AST作为代码生成的基础。为了代码生成，AST通常被用来生成一个中间表示（intermediate representation， IR），有时也叫做中间语言（intermediate language）。

### See also

